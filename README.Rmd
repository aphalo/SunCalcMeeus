---
output:
  github_document:
    html_preview: TRUE
---

```{r, echo = FALSE}
knitr::opts_chunk$set(
  fig.asp = 2/3,
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-"
)
```

# SunCalcMeeus <img src="man/figures/logo.png" align="right" width="120"/>

<!-- badges: start -->
 [![CRAN version](https://www.r-pkg.org/badges/version-last-release/SunCalcMeeus)](https://cran.r-project.org/package=SunCalcMeeus) [![cran checks](https://badges.cranchecks.info/worst/SunCalcMeeus.svg)](https://cran.r-project.org/web/checks/check_results_SunCalcMeeus.html)[![SunCalcMeeus status badge](https://aphalo.r-universe.dev/badges/SunCalcMeeus)](https://aphalo.r-universe.dev/SunCalcMeeus)
 [![R-CMD-check](https://github.com/aphalo/SunCalcMeeus/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/aphalo/SunCalcMeeus/actions/workflows/R-CMD-check.yaml)
[![Documentation](https://img.shields.io/badge/documentation-SunCalcMeeus-informational.svg)](https://docs.r4photobiology.info/SunCalcMeeus/)
<!-- badges: end -->
  
Package '**SunCalcMeeus**' implements Meeus' accurate algorithms for the computation of the position of the sun, usable far into the past and future. It also implements the computation of local solar time, day length, night length and times of sunset and sunrise, based on accepted and arbitrary sun elevation angles for twilight.

The same Meeus' algorithms are used  in the [NOAA Solar Calculator](https://gml.noaa.gov/grad/solcalc/) of the United States National Oceanic and Atmospheric Administration (NOAA), Global Monitoring Laboratory. The version of the algoritm implemented in 'SunCalcMeeus' is not the simplified one used in the [worksheets available from NOAA](https://gml.noaa.gov/grad/solcalc/calcdetails.html) but instead nearly identical to that used in the on line calculator and assumed to be accurate enough to be used for times between years 2000 BC to 3000 AC.

The functions provided are vectorised, and the best performance is achieved when vectors of instants in time are passed as arguments, as the equation of time is in this case computed only once for each geographic location.

## History

This package is part of a suite of R packages for photobiological calculations described at the [r4photobiology](https://www.r4photobiology.info) web site and in the vignette [The R for Photobiology Suite](https://docs.r4photobiology.info/photobiology/articles/userguide-0-r4p-introduction.html).

The functions now in 'SunCalcMeeus' were previously in package 'photobiology'. As they are being used in other contexts they are now published in as a separate R package to facilitate both their use and maintenance.

## Examples

Example of simple astronomical calculations for the sun.

```{r example2}
library(SunCalcMeeus)

# using times
geocode <- data.frame(lon = 0, lat = 55)
time <- lubridate::now(tzone = "UTC")

sunrise_time(date, tz = "UTC", geocode = geocode)

```


```{r example2}
day_length(date, tz = "UTC", geocode = geocode)
```

## Installation

Installation of the most recent stable version from CRAN:

```{r, eval=FALSE}
install.packages("SunCalcMeeus")
```

Installation of the current unstable version from R-Universe CRAN-like repository:

```{r, eval=FALSE}
install.packages('SunCalcMeeus', 
                 repos = c('https://aphalo.r-universe.dev', 
                           'https://cloud.r-project.org'))
```

Installation of the current unstable version from GitHub:

```{r, eval=FALSE}
# install.packages("devtools")
devtools::install_github("aphalo/SunCalcMeeus")
```

## Documentation

HTML documentation is available at (<https://docs.r4photobiology.info/SunCalcMeeus/>), including three *User Guides*.

News on updates to the different packages of the 'r4photobiology' suite are regularly posted at (<https://www.r4photobiology.info/>).

Two articles introduce the basic ideas behind the design of the suite and describe its use: Aphalo P. J. (2015) (<https://doi.org/10.19232/uv4pb.2015.1.14>) and Aphalo P. J. (2016) (<https://doi.org/10.19232/uv4pb.2016.1.15>).

A book is under preparation, and the draft is currently available at (<https://leanpub.com/r4photobiology/>).

A handbook written before the suite was developed contains useful information on the quantification and manipulation of ultraviolet and visible radiation: Aphalo, P. J., Albert, A., Björn, L. O., McLeod, A. R., Robson, T. M., & Rosenqvist, E. (Eds.) (2012) Beyond the Visible: A handbook of best practice in plant UV photobiology (1st ed., p. xxx + 174). Helsinki: University of Helsinki, Department of Biosciences, Division of Plant Biology. ISBN 978-952-10-8363-1 (PDF), 978-952-10-8362-4 (paperback). PDF file available from (<https://hdl.handle.net/10138/37558>).

## Contributing

Pull requests, bug reports, and feature requests are welcome at (<https://github.com/aphalo/SunCalcMeeus>).

## Citation

If you use this package to produce scientific or commercial publications, please cite according to:

```{r}
citation("SunCalcMeeus")
```

## License

© 2012-2024 Pedro J. Aphalo ([pedro.aphalo\@helsinki.fi](mailto:pedro.aphalo@helsinki.fi){.email}). Released under the GPL, version 2 or greater. This software carries no warranty of any kind.
